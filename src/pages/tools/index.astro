---
import Layout from '../../layouts/Layout.astro';
import fs from 'node:fs/promises';
import path from 'node:path';

const registryPath = path.resolve('tools/registry.json');
const registryData = await fs.readFile(registryPath, 'utf-8');
const registry = JSON.parse(registryData);

const tools = await Promise.all(registry
  .filter((entry: any) => entry.status === 'active')
  .map(async (entry: any) => {
    const defPath = path.resolve(`tools/definitions/${entry.slug}.json`);
    const defData = await fs.readFile(defPath, 'utf-8');
    return { ...entry, definition: JSON.parse(defData) };
  })
);

// Sort tools by priority to keep core decision engines at the top
tools.sort((a, b) => a.priority - b.priority);
---

<Layout title="All Career Decision Tools | Econified" description="Complete directory of our privacy-first, deterministic career and salary calculators." canonicalUrl="https://econified.com/tools/">
  <main class="container">
    <nav class="breadcrumb" style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 1rem;">
      <a href="/" style="color: inherit;">Home</a> &rsaquo; Tools
    </nav>
    <div style="text-align: left; margin-bottom: 3rem;">
      <h1>Career Decision Tools</h1>
      <p class="lead">A complete directory of all our interactive calculators and comparison engines. Every tool runs locally in your browser to guarantee your privacy.</p>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem;">
      {tools.map((tool: any) => (
        <a href={`/${tool.slug}/`} class="glass-panel" style="display: block; text-decoration: none;">
          <h2 style="color: var(--primary-light); margin-bottom: 0.5rem; font-size: 1.25rem;">{tool.definition.title}</h2>
          <p style="color: var(--text-secondary); margin-bottom: 0; font-size: 0.95rem;">{tool.definition.description}</p>
        </a>
      ))}
    </div>
  </main>
</Layout>
